---
title: "Beyond Expensive Nitrate Sensors: Smarter Ways to Monitor Water Quality"
author: "M. Zulkifli Falaqi"
date: "2025-10-10"
categories: [water quality, data modelling, nitrate]
toc: true
toc-location: right
---

Do we really need a DNA test every time we want to prove that someone is related to their parents? A DNA test surely gives the most precise answer, but it also costs time and money. In many cases, simpler clues, like matching blood type, similar eye color, or shared facial traits, when it combined, already tell most of the story. 

River scientists face a similar challenge, except theirs is about keeping up with change, nitrate levels can fluctuate by the minute, so measurements need to be nearly continuous. Nitrate is a vital nutrient that turns into a problem when there’s too much of it. Excess nitrate can trigger algal blooms, reduce oxygen levels, and disturb aquatic ecosystems, so tracking its movement through rivers is crucial.

The problem is that the instruments capable of measuring nitrate directly, such as the SUNA V2 optical nitrate sensor, are expensive, maintenance-heavy, and record data only every 15 minutes. Although this rate is considered high-frequency compared with traditional sampling, it still misses short-term fluctuations that occur with rainfall or biological activity.

Meanwhile, rivers are already monitored by other high-frequency sensors that measure temperature, dissolved oxygen, conductivity, turbidity, and water level every minute. These sensors are cheaper, easier to maintain, and widely deployed. If their combined signals can be used to estimate nitrate accurately, scientists could track nitrate dynamics in near real time without depending solely on costly equipment.

That’s the problem explored by Kermorvant et al. (2023) in PLOS ONE. Previous studies using Neural Networks, Random Forests, or GLMMs focused mainly on prediction and struggled to explain underlying relationships. Here, the authors used Generalised Additive Mixed Models (GAMMs) that is flexible enough to capture curved, site-specific patterns yet interpretable enough to reveal how each variable influences nitrate. Their approach points to a practical solution for one of water science’s problems: how to monitor nitrate continuously, affordably, and meaningfully.


# Key Results

## Site characteristics

The study compared three contrasting sites: Arikaree (semi-arid, Colorado), Caribou (subarctic, Alaska), and Lewis Run (temperate, urban/agricultural, Virginia). Initial water-quality conditions varied substantially. Lewis Run has the highest nitrate concentrations, Caribou intermediate, and Arikaree the lowest. Other variables such as temperature, dissolved oxygen, conductance, and turbidity also displayed distinct patterns across sites.

## Temporal fluctuations

Sensor data revealed both daily diel cycles and responses to flow events. For example, in Caribou nitrate and dissolved oxygen tended to rise during the day, whereas in Arikaree nitrate declined. During flow events, nitrate increased with rising elevation in Arikaree but decreased in Lewis Run.

[white-break]{style="color: white;"}

## Non-linear relationships

The GAM analysis highlighted non-linear and site-specific relationships (see @fig-3). In Caribou, temperature correlated positively with nitrate, while conductivity correlated negatively. In Arikaree, temperature showed a weak negative influence. In Lewis Run, almost all variables were influential, with mostly positive relationships.

::: {#fig-3}
![](images/clipboard-625438660.png){fig-align="center" width="580"}

Non-linear relationships between water-quality variables and nitrate. Smooth curves illustrate non-linear effects of each variable. Relationships vary by site, such as positive effects of temperature in Caribou but negative in Arikaree.
:::

## Variable importance

Deviance explained indicated that the relative importance of variables differs among sites (see @fig-4). In Arikaree, water-quality variables contributed little (\<5%) while the ARIMA component explained about 25% of the variance. In Caribou, specific conductance was dominant (\~10%). In Lewis Run, all variables contributed significantly (11–15%), with conductance again strongest.

::: {#fig-4}
![](images/clipboard-304808532.png){fig-align="center" width="460"}

Relative importance of variables at each site. Total deviance explained by each GAMM was 99% for all three sites.
:::

## Model performance

Using GAMs alone, the models explained about 75–85% of nitrate variation, showing that non-linear relationships with other water-quality variables capture most of the signal. Yet, residuals still showed temporal patterns. By adding ARIMA to model this auto-correlation, the combined GAMMs explained up to 99% of the variation.

Approximate AIC values were consistently lower for GAMMs than for GAMs, confirming that the improvement reflected a better model, not just extra complexity. In short, including the temporal component made the models both more accurate and more reliable.

# Brief Methods

The data came from the National Ecological Observatory Network (NEON), which provides high-frequency in-situ water-quality measurements at three contrasting sites observed. Most variables (temperature, dissolved oxygen, conductivity, turbidity, surface water elevation) were measured every 1 minute, while nitrate was measured every 15 minutes using a more costly sensor. To align the datasets, all variables were aggregated to a common 15-minute interval.

The modeling framework was built in two steps:

## 1. Generalised Additive Models (GAMs)

-   Nitrate was modeled as a non-linear function of time, temperature, dissolved oxygen, conductivity, turbidity (log-transformed), and surface water elevation.

-   Variable selection was guided by stepwise AIC and multicollinearity was checked using VIF.

## 2. ARIMA (Autoregressive Integrated Moving Average)

-   GAM residuals were modeled with ARIMA to capture temporal auto-correlation.

-   The optimal ARIMA model varied by site.

The final GAMM combined both components, providing robust and interpretable models of nitrate dynamics. The overall model framework can be expressed as follows:

::: {style="font-size:80%"}

$Nitrate(t)=f(time,temperature,DO,conductance,log(turbidity),surface\ elevation)+ARIMA\ residuals$

:::

Here, $f$ represents smooth non-linear functions estimated by the GAM. The ARIMA residual term models short-term temporal dependence in the series. Time appears as a covariate in the GAM to capture systematic cycles (diel or seasonal patterns), and as the time index $t$ of the series, which ARIMA uses to describe correlations between consecutive observations. The modeling might be computationally intensive, but it remains feasible with available tools and is suitable for applied monitoring.

# Conclusion

This study demonstrates that GAMMs are an accurate and interpretable framework for modeling nitrate dynamics in rivers. The approach is practically relevant because it reduces reliance on costly nitrate sensors, allows for imputation of missing data, and can be applied across sites with local recalibration.

For the company, this framework can be integrated into broader water-quality monitoring strategies. Pilot testing with local datasets is recommended to adjust the relationships among variables and confirm the model’s suitability for local ecosystem conditions.

# References

Kermorvant, C., Liquet, B., Litt, G., Hyndman, R. J., Peterson, E. E., Leigh, C., & Mengersen, K. (2023). Understanding links between water-quality variables and nitrate concentration in freshwater streams using high frequency sensor data. PLOS ONE, 18(6), e0287640. <https://doi.org/10.1371/journal.pone.0287640>


