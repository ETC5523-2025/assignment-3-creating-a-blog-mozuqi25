{
  "hash": "eae4aa24407c214fa9ba4ec1d51e0331",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"How Data Models Could Make River Monitoring More Affordable\"\nauthor: \"M. Zulkifli Falaqi\"\ndate: \"2025-10-10\"\ncategories: [water quality, data models, nitrate]\ntags: [GAMM]\ntoc: true\ntoc-location: right\nimage: \"images/river-water.jpeg\"\n---\n\nDo we really need a DNA test every time we need to prove that someone is related to their parents? A DNA test surely gives the most precise answer, but it also costs time and money. In many cases, simpler clues, like matching blood type, similar eye color, or shared facial traits, when it combined, already tell most of the story.\n\nRiver scientists face a similar challenge, except theirs is about keeping up with change, nitrate levels can fluctuate by the minute, so measurements need to be nearly continuous. Nitrate is a vital nutrient that turns into a problem when there’s too much of it. Excess nitrate can trigger algal blooms, reduce oxygen levels, and disturb aquatic ecosystems, so tracking its movement through rivers is crucial.\n\n## The Challenge Beneath the Surface {#sec-problem}\n\nThe problem lies in measuring nitrate directly. Instruments like the `SUNA V2` optical nitrate sensor, are expensive, maintenance-heavy, and record data only every 15 minutes. Although this rate is considered high-frequency compared with traditional sampling, it still misses short-term fluctuations that occur with rainfall or biological activity.\n\nMeanwhile, rivers are already monitored by other high-frequency sensors that measure river water variables such as temperature, dissolved oxygen, conductivity, turbidity, and water level every minute. These sensors are cheaper, easier to maintain, and widely deployed. If their combined signals can be used to estimate nitrate accurately, scientists could track nitrate dynamics in near real time without depending solely on costly equipment.\n\nThat’s the problem explored by [Kermorvant et al. (2023)](https://doi.org/10.1371/journal.pone.0287640). Previous studies using Neural Networks, Random Forests, or GLMM focused mainly on prediction and struggled to explain underlying relationships. Here, the authors used Generalised Additive Mixed Models (GAMM) that is flexible enough to capture curved, site-specific patterns yet interpretable enough to reveal how each variable influences nitrate. Their approach points to a practical solution for one of water science’s problems: how to monitor nitrate continuously, affordably, and meaningfully.\n\n## Turning Ordinary Sensors Into Smart Ones {#sec-analysis}\n\nAfter framing the problem, the next step was to test whether simple, fast sensors could truly stand in for the costly nitrate instruments. To do this, [Kermorvant et al. (2023)](https://doi.org/10.1371/journal.pone.0287640) used open environmental data and advanced statistical modeling to explore how different water-quality variables interact with nitrate across a range of climates and landscapes.\n\n### Where the Data Came From\n\nThe study used data from the National Ecological Observatory Network (NEON), a U.S. research infrastructure that collects environmental data from diverse ecosystems. Three rivers were chosen to span semi-arid, subarctic, and temperate settings (@tbl-sites). Each site had a `SUNA V2` nitrate sensor (15-min) plus high-frequency (1-min) sensors for temperature, dissolved oxygen, specific conductance, turbidity, and water level.\n\n\n::: {#tbl-sites .cell .tbl-cap-location-bottom tbl-cap='Study sites spanning distinct hydro-climatic contexts.'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;background-color: white !important;\"> Site </th>\n   <th style=\"text-align:center;background-color: white !important;\"> Location </th>\n   <th style=\"text-align:center;background-color: white !important;\"> Climate </th>\n   <th style=\"text-align:center;background-color: white !important;\"> Landscape </th>\n   <th style=\"text-align:center;background-color: white !important;\"> Typical Nitrate Level </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;background-color: white !important;\"> Arikaree River </td>\n   <td style=\"text-align:center;background-color: white !important;\"> Colorado </td>\n   <td style=\"text-align:center;background-color: white !important;\"> Semi-arid </td>\n   <td style=\"text-align:center;background-color: white !important;\"> Grassland, agriculture </td>\n   <td style=\"text-align:center;background-color: white !important;\"> Low </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;background-color: white !important;\"> Caribou Creek </td>\n   <td style=\"text-align:center;background-color: white !important;\"> Alaska </td>\n   <td style=\"text-align:center;background-color: white !important;\"> Subarctic </td>\n   <td style=\"text-align:center;background-color: white !important;\"> Subarctic taiga, discontinuous permafrost </td>\n   <td style=\"text-align:center;background-color: white !important;\"> Moderate </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;background-color: white !important;\"> Lewis Run </td>\n   <td style=\"text-align:center;background-color: white !important;\"> Virginia </td>\n   <td style=\"text-align:center;background-color: white !important;\"> Temperate </td>\n   <td style=\"text-align:center;background-color: white !important;\"> Fields, pastures, woodlands, small ponds </td>\n   <td style=\"text-align:center;background-color: white !important;\"> High </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Two Steps to Smarter Modeling\n\nThe modeling framework then was built in two steps:\n\n###### 1. Generalised Additive Models (GAM)\n\n-   Nitrate was modeled as a non-linear function of time, temperature, dissolved oxygen, conductivity, turbidity (log-transformed), and surface water elevation.\n\n-   Variable selection was guided by stepwise AIC and multicollinearity was checked using VIF.\n\n###### 2. ARIMA (Autoregressive Integrated Moving Average)\n\n-   GAM residuals were modeled with ARIMA to capture temporal auto-correlation.\n\n-   The optimal ARIMA model varied by site.\n\nThe final GAMM combined both components, providing robust and interpretable models of nitrate dynamics. The overall model framework can be expressed as follows:\n\n::: {style=\"font-size:80%\"}\n$Nitrate(t)=f(time,temperature,DO,conductance,log(turbidity),surface\\ elevation)+ARIMA\\ residuals$\n:::\n\nHere, $f$ represents smooth non-linear functions estimated by the GAM. The ARIMA residual term models short-term temporal dependence in the series. Time appears as a covariate in the GAM to capture systematic cycles (diel or seasonal patterns), and as the time index $t$ of the series, which ARIMA uses to describe correlations between consecutive observations.\n\nThe modeling might be computationally intensive, but it remains feasible with available tools and is suitable for applied monitoring.\n\n### What the Research Revealed{#sec-finding}\n\n#### Temporal fluctuations\n\nSensor data revealed both daily diel cycles and responses to flow events (see @fig-diel). For example, in Caribou nitrate and dissolved oxygen tended to rise during the day, whereas in Arikaree nitrate declined. During flow events, nitrate increased with rising elevation in Arikaree but decreased in Lewis Run.\n\n::: {#fig-diel}\n![](images/clipboard-728123222.png){fig-align=\"center\" width=\"600\"}\n\nExamples of daily patterns and short-term events in water quality at the three study sites. The top panels show 5-day snapshots highlighting daily cycles and trends in key variables.\nThe bottom panels show flow events marked by sharp increases in water-surface elevation.\n:::\n\n#### Non-linear relationships\n\nThe GAM analysis highlighted non-linear and site-specific relationships (see @fig-non-linear). In Caribou, temperature correlated positively with nitrate, while conductivity correlated negatively. In Arikaree, temperature showed a weak negative influence. In Lewis Run, almost all variables were influential, with mostly positive relationships.\n\n::: {#fig-non-linear}\n![](images/clipboard-625438660.png){fig-align=\"center\" width=\"600\"}\n\nNon-linear relationships between water-quality variables and nitrate. Smooth curves illustrate non-linear effects of each variable.\n:::\n\n#### Variable importance\n\nDeviance explained indicated that the relative importance of variables differs among sites (see @fig-importance). In Arikaree, water-quality variables contributed little (\\<5%) while the ARIMA component explained about 25% of the variance. In Caribou, specific conductance was dominant (\\~10%). In Lewis Run, all variables contributed significantly (11–15%), with conductance again strongest.\n\n::: {#fig-importance}\n![](images/clipboard-304808532.png){fig-align=\"center\" width=\"460\"}\n\nRelative importance of variables differ at each site.\n:::\n\n#### Model performance\n\nAs shown in @tbl-performance, the analysis directly addressed the problem of relying on costly nitrate sensors by testing how well common, faster measurements could reproduce the same signal.\n\nUsing GAM alone, the model explained about 75–85% of the variation in nitrate concentration, indicating that non-linear relationships among affordable, high-frequency variables already capture most of the nitrate behavior.\n\nHowever, the remaining differences revealed short-term temporal fluctuations that these models could not fully describe. By adding the ARIMA component to handle this time-based dependence, the combined GAMM improved substantially—explaining up to 99% of nitrate variation and closely matching the performance of direct nitrate measurements.\n\n\n::: {#tbl-performance .cell .tbl-cap-location-bottom tbl-cap='Model performance across the three rivers.'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:center;text-align: center;background-color: white !important;\"> Site </th>\n   <th style=\"text-align:right;text-align: center;background-color: white !important;\"> GAM Performance </th>\n   <th style=\"text-align:right;text-align: center;background-color: white !important;\"> GAMM Performance </th>\n   <th style=\"text-align:right;text-align: center;background-color: white !important;\"> Improvement </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;background-color: white !important;\"> Arikaree River </td>\n   <td style=\"text-align:right;background-color: white !important;\"> 75% </td>\n   <td style=\"text-align:right;background-color: white !important;\"> 99% </td>\n   <td style=\"text-align:right;background-color: white !important;\"> +24% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;background-color: white !important;\"> Caribou Creek </td>\n   <td style=\"text-align:right;background-color: white !important;\"> 83% </td>\n   <td style=\"text-align:right;background-color: white !important;\"> 99% </td>\n   <td style=\"text-align:right;background-color: white !important;\"> +16% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;background-color: white !important;\"> Lewis Run </td>\n   <td style=\"text-align:right;background-color: white !important;\"> 85% </td>\n   <td style=\"text-align:right;background-color: white !important;\"> 99% </td>\n   <td style=\"text-align:right;background-color: white !important;\"> +14% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nApproximate AIC values were consistently lower for GAMM than for GAM, confirming that the improvement reflected a better model, not just extra complexity. In short, including the temporal component made the models both more accurate and more reliable.\n\n## So, What Does This Mean? {#sec-conclusion}\n\nThis study from [Kermorvant et al. (2023)](https://doi.org/10.1371/journal.pone.0287640) shows that Generalised Additive Mixed Models (GAMM) offer a practical way to address the long-standing problem of monitoring nitrate continuously and affordably. By combining data from fast, low-cost sensors with an interpretable statistical framework, the approach reduces dependence on expensive nitrate instruments like the `SUNA V2`, while still capturing near-real-time nitrate dynamics.\n\nThe results demonstrate that GAMM can explain most of the variation in nitrate using only common water-quality variables such as temperature, oxygen, conductivity, turbidity, and water level.\nBecause the method remains transparent and adaptable, it can be recalibrated for new sites and used to fill gaps when nitrate sensors fail or are unavailable.\n\nFor organizations or agencies managing water resources, this framework could be integrated into existing monitoring networks.\nTesting the model with local data would help refine variable relationships and confirm its suitability for regional conditions — ultimately supporting broader, data-driven strategies for managing river health and water quality.\n\n## References {#sec-references}\n\nKermorvant, C., Liquet, B., Litt, G., Hyndman, R. J., Peterson, E. E., Leigh, C., & Mengersen, K. (2023). Understanding links between water-quality variables and nitrate concentration in freshwater streams using high frequency sensor data. PLOS ONE, 18(6), e0287640. <https://doi.org/10.1371/journal.pone.0287640>\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}